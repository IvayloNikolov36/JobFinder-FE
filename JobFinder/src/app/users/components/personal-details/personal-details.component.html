<form [formGroup]="personalInfoForm">

  <div class="d-flex justify-content-start gap-3 mt-3">

    <mat-form-field class="quarter-width">
      <input matInput type="text" placeholder="First Name" formControlName="firstName">
      <mat-hint>Enter first name.</mat-hint>
      @if (personalInfoForm.get('firstName')?.touched && personalInfoForm.get('firstName')?.errors?.['required']) {
      <mat-error>First name is required!</mat-error>
      }
      @if (personalInfoForm.get('firstName')?.errors?.['minlength']) {
      <mat-error>First name length must be at least
        {{personalInfoForm.get('firstName')?.errors?.['minlength']['requiredLength']}} characters!
      </mat-error>
      }
      @if (personalInfoForm.get('firstName')?.errors?.['maxlength']) {
      <mat-error>First name length must be no more than
        {{personalInfoForm.get('firstName')?.errors?.['maxlength']['requiredLength']}} characters!
      </mat-error>
      }
    </mat-form-field>

    <mat-form-field class="quarter-width">
      <input matInput type="text" placeholder="Middle Name" formControlName="middleName">
      <mat-hint>Enter middle name.</mat-hint>
      @if (personalInfoForm.get('middleName')?.touched && personalInfoForm.get('middleName')?.errors?.['required']) {
      <mat-error>Middle name is required!</mat-error>
      }
      @if (personalInfoForm.get('middleName')?.errors?.['minlength']) {
      <mat-error>Middle name length must be at least
        {{personalInfoForm.get('middleName')?.errors?.['minlength']['requiredLength']}} characters!
      </mat-error>
      }
      @if (personalInfoForm.get('middleName')?.errors?.['maxlength']) {
      <mat-error>Middle name length must be no more than
        {{personalInfoForm.get('middleName')?.errors?.['maxlength']['requiredLength']}} characters!
      </mat-error>
      }
    </mat-form-field>

    <mat-form-field class="quarter-width">
      <input matInput type="text" placeholder="Last Name" formControlName="lastName">
      <mat-hint>Enter last name.</mat-hint>
      @if (personalInfoForm.get('lastName')?.touched && personalInfoForm.get('lastName')?.errors?.['required']) {
      <mat-error>Last name is required!</mat-error>
      }
      @if (personalInfoForm.get('lastName')?.errors?.['minlength']) {
      <mat-error>
        Last name length must be at least {{personalInfoForm.get('lastName')?.errors?.['minlength']['requiredLength']}}
        characters!
      </mat-error>
      }
      @if (personalInfoForm.get('lastName')?.errors?.['maxlength']) {
      <mat-error>Last name length must be no more than
        {{personalInfoForm.get('lastName')?.errors?.['maxlength']['requiredLength']}} characters!
      </mat-error>
      }
    </mat-form-field>

  </div>

  <div class="d-flex justify-content-start gap-3 mt-4">
    <mat-form-field class="quarter-width">
      <input matInput type="text" placeholder="Email" formControlName="email">
      <mat-hint>Enter email.</mat-hint>
      @if (personalInfoForm.get('email')?.touched && personalInfoForm.get('email')?.errors?.['required']) {
      <mat-error>Email is required!</mat-error>
      }
      @if (personalInfoForm.get('email')?.errors?.['pattern']) {
      <mat-error>Email is invalid!</mat-error>
      }
    </mat-form-field>

    <mat-form-field class="quarter-width">
      <input matInput type="text" placeholder="Phone" formControlName="phone">
      <mat-hint>Enter phone.</mat-hint>
      @if (personalInfoForm.get('phone')?.touched && personalInfoForm.get('phone')?.errors?.['required']) {
      <mat-error>Phone is required!</mat-error>
      }
      @if (personalInfoForm.get('phone')?.touched && personalInfoForm.get('phone')?.errors?.['minlength']) {
      <mat-error>
        Phone must be exactly {{personalInfoForm.get('phone')?.errors?.['minlength']['requiredLength']}}
        characters!
      </mat-error>
      }
      @if (personalInfoForm.get('phone')?.touched && personalInfoForm.get('phone')?.errors?.['maxlength']) {
      <mat-error>
        Phone must be exactly {{personalInfoForm.get('phone')?.errors?.['maxlength']['requiredLength']}} characters!
      </mat-error>
      }
    </mat-form-field>
  </div>

  <div class="d-flex justify-content-start gap-3 mt-4">
    <mat-form-field class="quarter-width">
      <input matInput [matDatepicker]="birthdatePicker" placeholder="Bithdate" formControlName="birthdate">
      <mat-datepicker-toggle matSuffix [for]="birthdatePicker"></mat-datepicker-toggle>
      <mat-datepicker #birthdatePicker></mat-datepicker>
      <mat-hint>Select birthdate.</mat-hint>
      @if (personalInfoForm.get('birthdate')?.touched && personalInfoForm.get('birthdate')?.errors?.['required']) {
      <mat-error>Birthdate is required!</mat-error>
      }
    </mat-form-field>

    <mat-form-field class="quarter-width">
      <mat-label>Gender</mat-label>
      <mat-select formControlName="gender" [compareWith]="compareFn">
        @for (g of genderOptions(); track g.id) {
        <mat-option [value]="g">{{ g.name }}</mat-option>
        }
      </mat-select>
      <mat-hint>Select gender.</mat-hint>
      @if (personalInfoForm.get('gender')?.touched && personalInfoForm.get('gender')?.errors?.['required']) {
      <mat-error>Gender is required!</mat-error>
      }
    </mat-form-field>
  </div>

  <div class="d-flex justify-content-start gap-3 mt-4">

    <mat-form-field class="quarter-width">
      <input matInput type="text" placeholder="Current City" formControlName="city">
      <mat-hint>Enter city.</mat-hint>
      @if (personalInfoForm.get('city')?.touched && personalInfoForm.get('city')?.errors?.['required']) {
      <mat-error>City is required!</mat-error>
      }
      @if (personalInfoForm.get('city')?.errors?.['minlength']) {
      <mat-error>City length must be at least
        {{personalInfoForm.get('city')?.errors?.['minlength']['requiredLength']}}characters!</mat-error>
      }
      @if (personalInfoForm.get('city')?.errors?.['maxlength']) {
      <mat-error>
        City length must be no more than
        {{personalInfoForm.get('city')?.errors?.['maxlength']['requiredLength']}} characters!
      </mat-error>
      }
    </mat-form-field>

    <mat-form-field class="quarter-width">
      <mat-label>Citizenship</mat-label>
      <mat-select formControlName="citizenship" [compareWith]="compareFn">
        @for (c of citizenships(); track c.id) {
        <mat-option [value]="c">{{ c.name }}</mat-option>
        }
      </mat-select>
      <mat-hint>Select citizenship.</mat-hint>
      @if (personalInfoForm.get('gender')?.touched && personalInfoForm.get('gender')?.errors?.['required']) {
      <mat-error>Citizenship is required!</mat-error>
      }
    </mat-form-field>

    <mat-form-field class="quarter-width">
      <mat-label>Country</mat-label>
      <mat-select formControlName="country" [compareWith]="compareFn">
        @for (c of countries(); track c.id) {
        <mat-option [value]="c">{{ c.name }}</mat-option>
        }
      </mat-select>
      <mat-hint>Select country.</mat-hint>
      @if (personalInfoForm.get('country')?.touched && personalInfoForm.get('country')?.errors?.['required']) {
      <mat-error>Country is required!</mat-error>
      }
    </mat-form-field>
  </div>

  <div class="mt-4">
    @if (isEditMode) {
    <button type="submit" mat-button class="mt-3" color="primary" (click)="emitData()"
      [disabled]="!personalInfoForm.valid">
      Update
    </button>
    }
    @else {
    <button type="submit" mat-button class="mt-3" color="primary" matStepperNext (click)="emitData()"
      [disabled]="!personalInfoForm.valid">
      Next
    </button>
    }
  </div>

</form>